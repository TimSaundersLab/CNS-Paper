Generating Global Matrices
Applying Constraints
